---
alwaysApply: true
---

# üßæ Product Requirements Document (PRD)

## üì± Product Name

**Turi**

---

## üß≠ Overview

**Turi** is a fun, lightweight app that helps groups (families, roommates, teams) manage **recurring shared tasks** ‚Äî like chores, cooking, or cleaning ‚Äî by showing **whose turn it is** in a friendly, Duolingo-style interface.

Version 1 (MVP) focuses on **local-only functionality** with **no accounts or cloud sync**, just fast and delightful task rotation.

---

## üéØ Goals

- Simplify managing shared, repetitive tasks.
- Make task tracking fun, visual, and easy to maintain.

---

## üö´ Out of Scope (v1)

- User accounts / authentication.
- Cloud sync or real-time updates.
- Analytics / detailed reporting.

---

## üß© Core Features

### 1. **Groups**

- Create, view, edit, and delete groups.
- Each group has:

  - Name
  - Icon (Lucide icon)
  - Color theme (gradient start/end colors)
  - Member list
  - Task list

### 2. **Members**

- Add members by name (initials-based avatar with random color).
- Order defines task rotation sequence.
- Delete or edit member (swipe-to-reveal actions).
- Avatars display member initials with Microsoft Teams-style color palette.

### 3. **Tasks**

- Add tasks within a group.
- Each task has:

  - Task name
  - Icon (Lucide icon)
  - Frequency (daily / weekly / monthly)
  - Scheduling options (optional):
    - **For weekly tasks:** Day of week (Sun-Sat), Time (optional)
    - **For monthly tasks:** Week of month (1st-4th), Day of week (Sun-Sat), Time (optional)
    - **For daily tasks:** Time (optional)
  - Assigned members (rotation follows member list)
  - Completion history (tracking who completed when)
  - Skip history (tracking who skipped when)

- "Mark Done" button rotates to the next member.
- Tasks can only be completed once per period (daily/weekly/monthly).
- Task cards display schedule information prominently.
- Visual overdue indicators when tasks are past their due period.

### 4. **Rotation Logic**

- Tasks start with the first member in the group list.
- When ‚ÄúMark Done‚Äù is pressed:

  - Assigned index increases by 1.
  - If at the end, wraps to the first member.

Example:

```
Members = [Alice, Bob, Charlie]
Task: ‚ÄúWash Dishes‚Äù
CurrentTurn = Alice
‚Üí Mark Done ‚Üí NextTurn = Bob
‚Üí Mark Done ‚Üí NextTurn = Charlie
‚Üí Mark Done ‚Üí NextTurn = Alice
```

### 5. **Local Storage**

- All data stored using **AsyncStorage** (Expo).
- Data structure:

  ```ts
  Group {
    id: string;
    name: string;
    icon: string; // Lucide icon name
    colorStart: string; // Gradient start color
    colorEnd: string; // Gradient end color
    members: Member[];
    tasks: Task[];
  }

  Member {
    id: string;
    name: string;
    avatarColor: string; // Random color assigned for avatar
  }

  TaskCompletion {
    memberId: string;
    completedAt: string; // ISO date string
  }

  TaskSkip {
    memberId: string;
    skippedAt: string; // ISO date string
  }

  GroupActivity {
    id: string;
    type: 'task_completed' | 'task_skipped' | 'task_created' | 'task_deleted' | 'member_added' | 'member_deleted' | 'group_created';
    timestamp: string; // ISO date string
    actorId?: string; // Member ID who performed the action (optional)
    targetId?: string; // Task ID or Member ID that was affected
    metadata?: {
      taskName?: string;
      taskIcon?: string;
      memberName?: string;
    };
  }

  Task {
    id: string;
    name: string;
    icon: string; // Lucide icon name
    frequency: 'daily' | 'weekly' | 'monthly';
    assignedIndex: number;
    memberIds: string[];
    lastCompletedAt: string | null; // ISO date string for completion tracking
    completionHistory: TaskCompletion[]; // History of completions
    skipHistory: TaskSkip[]; // History of skips
    // Scheduling options (optional, only used when frequency is weekly or monthly)
    scheduleWeek?: number; // For monthly: 1-4 (first, second, third, fourth week)
    scheduleDay?: number; // 0-6 (Sunday = 0, Monday = 1, ..., Saturday = 6)
    scheduleTime?: string; // HH:MM format (24-hour), e.g., "14:30" for 2:30 PM
  }

  Group {
    id: string;
    name: string;
    icon: string; // Lucide icon name
    colorStart: string; // Gradient start color
    colorEnd: string; // Gradient end color
    members: Member[];
    tasks: Task[];
    createdAt: string; // ISO date string - when group was created
    activities: GroupActivity[]; // Activity feed for this group
  }
  ```

- Storage includes version field for future migrations.

### 6. **Gamification**

- Confetti or celebration animation on completion.
- Motivational messages like "Nice job!" or "Keep it going!"

### 7. **Solo Mode**

- Automatically enabled when a group has only one member.
- Tasks are automatically assigned to the single member.
- Rotation is disabled (tasks remain assigned to the solo user).
- UI elements adjust:
  - "Whose turn" indicators show "You" instead of member name
  - "Assign to" or member selection is hidden
  - "Skip" button is hidden
  - Solo mode badge appears: "Solo mode ‚Äî all tasks are yours üë§"
- When another member is added, automatically switches to normal rotation mode.

### 8. **Activity Feed**

- Chronological feed of all activities across all groups.
- Activity types tracked:
  - Task completed (who + when)
  - Task skipped (who + when)
  - Task created
  - Task deleted
  - Member added
  - Member deleted
  - Group created
- Filterable by type (All, Done, Skipped, Created, Members).
- Grouped by relative date (Today, Yesterday, This week, specific dates).
- Shows relative time ("Just now", "2h ago", "3d ago").
- Clickable items navigate to task details or group pages.
- Accessible from Settings ‚Üí Activity.

### 9. **Settings**

- Dark mode toggle (persists across app restarts).
- Activity link (navigates to Activity Feed).
- Notification preferences:
  - Toggle notifications on/off (with permission handling)
  - Reminder time setting (5 min, 10 min, 15 min, 30 min, 1 hour, 2 hours before task)
  - Shows permission status if denied
- Language preferences:
  - Language selector (navigates to Language selection page)
  - Supports multiple languages (currently English, more languages added as translations become available)
  - Language preference persists across app restarts
  - Automatically detects device language on first launch
- Placeholder sections for future features:
  - Account management
  - Support (Help & FAQ, Contact Support, About App)

### 11. **Internationalization (i18n)**

- All user-facing text must be translatable
- Translation files stored in `locales/` directory (JSON format)
- Uses i18next and react-i18next for translation management
- Language preference stored in AsyncStorage
- Default language: English
- Automatically detects device language on first launch
- Language selector available in Settings ‚Üí App Language
- ThemedText component supports translation via `i18nKey` prop
- When adding new text to the app, always use translation keys instead of hardcoded strings
- Translation keys follow namespace pattern: `section.item` (e.g., `settings.title`, `task.markDone`)
- New languages can be added by creating new translation files in `locales/` directory

### 12. **Notifications**

- Local notifications scheduled automatically for tasks with due dates/times.
- Notifications sent X minutes before task is due (configurable reminder time).
- Notification content:
  - Title: Task name with bell emoji
  - Body: Assigned member's name + schedule information
  - Includes task and group IDs for navigation
- Smart scheduling:
  - Only schedules for tasks that haven't been completed in the current period
  - Skips tasks with no assigned members
  - Automatically reschedules after task completion
  - Cancels notifications when tasks/groups are deleted
- Notification management:
  - Automatically scheduled when tasks are created/updated
  - Automatically cancelled when tasks are deleted
  - Rescheduled when tasks are completed (for next occurrence)
  - Rescheduled when member assignments change (skip turn, member deletion)
  - All notifications rescheduled on app initialization
  - Respects notification toggle preference
- Default behavior:
  - Tasks without scheduled time default to 9:00 AM
  - Daily tasks: Notification at scheduled time (or 9 AM) minus reminder minutes
  - Weekly tasks: Notification on scheduled day at scheduled time minus reminder minutes
  - Monthly tasks: Notification on scheduled week/day at scheduled time minus reminder minutes

---

## üß† User Stories

| #   | As a... | I want to...           | So that I can...                               |
| --- | ------- | ---------------------- | ---------------------------------------------- |
| 1   | User    | Create a group         | Organize shared tasks with my friends/family   |
| 2   | User    | Add members            | Define who participates in tasks               |
| 3   | User    | Add a new task         | Track who's responsible next                   |
| 4   | User    | View who's turn it is  | Know who should do the task today              |
| 5   | User    | Mark a task as done    | Automatically move turn to the next person     |
| 6   | User    | Get positive feedback  | Stay motivated to keep using the app           |
| 7   | User    | View activity feed     | See all completed and skipped tasks            |
| 8   | User    | Use solo mode          | Manage tasks when I'm the only member          |
| 9   | User    | Adjust app settings    | Customize my experience (dark mode, etc.)      |
| 10  | User    | See overdue tasks      | Know which tasks need attention                |
| 11  | User    | Enable notifications   | Get reminded before tasks are due              |
| 12  | User    | Set reminder time      | Choose how early I want to be notified         |
| 13  | User    | Receive task reminders | Know when it's my turn even when app is closed |

---

## üì± Screens & Components

### 1. **Home Screen**

- **Components:**

  - App title/logo
  - Group list (`GroupCard` with gradient backgrounds)
  - Add group button (FAB)
  - `AddGroupModal` (icon picker, color theme selector)

### 2. **Group Screen**

- **Components:**

  - Header with group icon + name + context menu (edit/delete)
  - Solo mode badge (when applicable)
  - Tabs: "Tasks" / "Members"
  - `TaskCardList` (displays schedule information on cards, shows "No Members Yet" message when empty)
  - `AddTaskButton` (FAB, only shown when group has members)
  - `MemberChipList` (swipe-to-reveal edit/delete actions)
  - `AddMemberButton` (FAB on Members tab)

### 3. **Task Details Screen**

- **Components:**

  - Task icon + name (gradient card matching group colors)
  - Full schedule information display (e.g., "Every Mon at 2:30 PM", "Monthly: First Fri")
  - Overdue indicator when task is past due
  - Current member responsible (with avatar, shows "You" in solo mode)
  - Completion history (with member avatars)
  - Mark done button (disabled when already completed, triggers confetti)
  - Skip button (hidden when completed or in solo mode)
  - Edit/Delete options (context menu)
  - Screen remains open after marking task as done

### 4. **Add Task Modal**

- Task name input
- Icon picker (Lucide icons)
- Frequency selector (daily/weekly/monthly)
- Scheduling options (conditional based on frequency):
  - **Weekly/Monthly:** Day selector (Sun-Sat)
  - **Monthly:** Week selector (1st-4th week)
  - **All frequencies:** Time picker (optional, native iOS/Android picker)
- Member selector (multi-select or default all)
- Save button

### 5. **Add Member Modal**

- Name input only (avatar color assigned automatically)
- Save button

### 6. **Settings Screen**

- **Components:**
  - Header with back button
  - ACCOUNT section (Activity link)
  - PREFERENCES section:
    - Notifications toggle (with permission status indicator)
    - Reminder time selector (shown when notifications enabled)
    - Dark Mode toggle
    - App Language placeholder
  - SUPPORT section (Help & FAQ placeholder, Contact Support placeholder, About App placeholder)

### 7. **Activity Feed Screen**

- **Components:**
  - Header with back button
  - Filter tabs (All, Done, Skipped, Created, Members)
  - Chronological activity list grouped by date
  - Activity items with icons, member avatars, group badges
  - Clickable items navigate to task details or group pages

### 8. **Gamification Layer**

- Confetti animation component
- Motivational message component

---

## üé® Design Direction

- Inspired by **Duolingo UI**: bright colors, rounded corners, playful illustrations.
- Typography: clean and friendly (e.g., Poppins or Nunito).
- Buttons: large, colorful, with simple icons.
- Animations: light bounce transitions, cheerful feedback on success.

---

## ‚öôÔ∏è Tech Stack

- **Framework:** React Native (Expo)
- **State Management:** Zustand
- **Storage:** AsyncStorage
- **Theme Management:** Zustand (global theme state)
- **Internationalization:** i18next, react-i18next, expo-localization
- **Animations:** react-native-reanimated (for gestures and animations), react-native-confetti-cannon
- **Navigation:** Expo Router (file-based routing, no bottom tab bar visible)
- **Icons:** Lucide React Native
- **Gradients:** expo-linear-gradient
- **Time Picker:** @react-native-community/datetimepicker
- **Notifications:** expo-notifications
- **Gestures:** react-native-gesture-handler
- **Safe Area:** react-native-safe-area-context

---

## üß™ QA & Testing Checklist

- [ ] Can create, edit, and delete groups.
- [ ] Can add, edit, and delete members (swipe actions).
- [ ] Can add, edit, and delete tasks.
- [ ] Task rotation correctly cycles through members.
- [ ] Monthly frequency works correctly.
- [ ] Scheduling options (week, day, time) save and display correctly.
- [ ] Time picker works on iOS and Android (native picker).
- [ ] Tasks can only be completed once per period (daily/weekly/monthly).
- [ ] Schedule information displays correctly on task cards and detail screen.
- [ ] Data persists after app restart.
- [ ] UI looks correct on iOS and Android.
- [ ] Confetti triggers on "Mark Done".
- [ ] Solo mode works correctly (auto-assignment, UI adjustments).
- [ ] Activity feed shows all activity types correctly.
- [ ] Activity filters work correctly.
- [ ] Overdue indicators display correctly.
- [ ] Dark mode toggle works and persists.
- [ ] FAB buttons respect safe area insets.
- [ ] Skip history is tracked correctly.
- [ ] Activity tracking works for all action types.
- [ ] Notification toggle works and persists preference.
- [ ] Notification permission request works correctly.
- [ ] Reminder time setting works and persists.
- [ ] Notifications are scheduled when tasks are created.
- [ ] Notifications are cancelled when tasks are deleted.
- [ ] Notifications are rescheduled when tasks are completed.
- [ ] Notifications are rescheduled when tasks are updated.
- [ ] Notifications are cancelled when groups are deleted.
- [ ] Notifications are rescheduled when members are deleted.
- [ ] Notifications are rescheduled when turn is skipped.
- [ ] Notifications are not sent for completed tasks.
- [ ] Notifications are not sent for tasks with no assigned members.
- [ ] Notifications are rescheduled on app initialization.
- [ ] Notification content displays correct member name and schedule.
- [ ] Default time (9 AM) is used for tasks without scheduled time.
- [ ] Language preference persists across app restarts.
- [ ] Language selector displays available languages correctly.
- [ ] All user-facing text uses translation keys (no hardcoded strings).
- [ ] Translation keys are properly structured and organized.
- [ ] App detects device language on first launch.

---

## üöÄ Future Versions (Post-v1 Ideas)

- Login and cloud sync (Firebase or Supabase).
- Push notifications (cloud-based, cross-device sync).
- Custom rotation order.
- Task history and stats.
- Shared links to invite members.
- Themes and advanced gamification (badges, levels, XP system).
- Notification sounds customization.
- Multiple reminder times per task.

---

## üìã MVP Implementation Decisions

### Task Assignment

- Default to **all members** assigned to a task.
- Optional subset selection can be added later if needed.

### Frequency Tracking

- Track minimal completion dates (last completed timestamp per task).
- Use frequency (daily/weekly/monthly) for display.
- Tasks can only be completed once per period (prevents duplicate completions).
- Schedule information (week, day, time) stored for weekly and monthly tasks.

### Gamification

- **Simple feedback only** (no streaks for MVP).
- Confetti animation on completion.
- Motivational messages.

### Data Structure

- Use PRD structure with **versioning** for future migrations.
- Add `lastCompletedAt` timestamp to Task for completion tracking.
- Add `completionHistory` array to Task for tracking completion history.
- Add `skipHistory` array to Task for tracking skip history.
- Add `scheduleWeek`, `scheduleDay`, `scheduleTime` to Task for scheduling (weekly/monthly).
- Add `createdAt` timestamp to Group for creation date.
- Add `activities` array to Group for activity feed tracking.
- Groups use Lucide icons and color themes (gradient start/end).
- Members use initials-based avatars with random color assignment.
- Tasks use Lucide icons.
- Activity tracking includes metadata for task names, icons, and member names.

### UI Build Priority

1. Home Screen ‚Üí Group List
2. Group Screen ‚Üí Tasks & Members
3. Task Details / Add Modals
4. Gamification Layer (confetti, messages)
5. Settings Screen
6. Activity Feed Screen
7. Solo Mode Implementation
8. Notification System (scheduling, preferences, management)
9. UI Polish & Safety (bounds checking, safe area insets, overdue indicators)

### Notification Implementation

- **Notification Store:** Zustand store for notification preferences (enabled/disabled, reminder minutes).
- **Notification Service:** Utility functions for scheduling, cancelling, and rescheduling notifications.
- **Notification Scheduling Logic:**
  - Calculates next due date based on task frequency and schedule
  - Schedules notification X minutes before due date (configurable)
  - Defaults to 9:00 AM for tasks without scheduled time
  - Skips scheduling if task is already completed for the period
  - Skips scheduling if task has no assigned members
- **Notification Lifecycle:**
  - Created: Scheduled when task is created (if notifications enabled)
  - Updated: Cancelled and rescheduled when task is updated
  - Completed: Cancelled and rescheduled for next occurrence
  - Deleted: Cancelled when task is deleted
  - Group Deleted: All group notifications cancelled
  - Member Deleted: All group notifications rescheduled
  - Skip Turn: Notification rescheduled with new assignee
  - App Init: All notifications rescheduled on app start
- **Notification Preferences:**
  - Stored in AsyncStorage
  - Default reminder time: 15 minutes
  - Reminder time options: 5, 10, 15, 30, 60, 120 minutes
  - Changing reminder time reschedules all notifications
- **Permission Handling:**
  - Requests permission when enabling notifications
  - Shows permission status in settings
  - Gracefully handles permission denial
